# FAIL-SAFE ARCHITECTURE - –§–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

**–î–∞—Ç–∞:** 2024-12-19  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** CRITICAL - Fail-safe —Å—Ç—Ä–æ–≥–æ –≤–∞–∂–Ω–µ–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

---

## üéØ –¶–ï–õ–¨

–°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –≥–¥–µ —Å–∏—Å—Ç–µ–º–∞ **–ù–ï –ú–û–ñ–ï–¢** —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.

**–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞–∑ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫:**
> "–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –ø–æ–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–µ–Ω."

---

## 1Ô∏è‚É£ –§–û–†–ú–ê–õ–¨–ù–´–ï –°–ò–°–¢–ï–ú–ù–´–ï –ò–ù–í–ê–†–ò–ê–ù–¢–´

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞

**–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç** ‚Äî —ç—Ç–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–µ —É—Å–ª–æ–≤–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ **–í–°–ï–ì–î–ê** –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏—Å—Ç–∏–Ω–Ω—ã–º –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã. –ù–∞—Ä—É—à–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞ = –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞–∑.

### –°–ø–∏—Å–æ–∫ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

#### INV-1: CRITICAL MODULE AVAILABILITY
```
‚àÄ module ‚àà CRITICAL_MODULES:
  IF module.unavailable OR module.invalid OR module.timeout
  THEN system_state ‚Üí SAFE_HALT
```

**–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
- `SystemGuardian` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—ã–π CRITICAL –º–æ–¥—É–ª—å –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ç–æ—Ä–≥–æ–≤—ã–º —Ä–µ—à–µ–Ω–∏–µ–º
- –ï—Å–ª–∏ –º–æ–¥—É–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –≤ `SAFE_HALT`
- –ù–µ—Ç –æ–±—Ö–æ–¥–Ω—ã—Ö –ø—É—Ç–µ–π

#### INV-2: DECISION CORE AUTHORITY
```
‚àÄ trading_decision:
  MUST pass through DecisionCore.should_i_trade()
  NO component may bypass DecisionCore
  DecisionCore is single source of truth
```

**–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
- `Gatekeeper` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `DecisionCore` –ø–µ—Ä–µ–¥ –ª—é–±–æ–π –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–∏–≥–Ω–∞–ª–∞
- `SystemGuardian` –±–ª–æ–∫–∏—Ä—É–µ—Ç –ª—é–±—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –æ–±—Ö–æ–¥–∞
- –í—Å–µ —Ä–µ—à–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å `decision_source="DecisionCore"`

#### INV-3: META DECISION BRAIN CRITICALITY
```
IF MetaDecisionBrain is CRITICAL:
  IF MetaDecisionBrain.unavailable OR MetaDecisionBrain.invalid
  THEN trading MUST be blocked
  NO fail-open allowed
```

**–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
- –ï—Å–ª–∏ `MetaDecisionBrain` –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ `CRITICAL`, –µ–≥–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å ‚Üí `SAFE_HALT`
- Fail-open –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ –¥–ª—è CRITICAL –º–æ–¥—É–ª–µ–π

#### INV-4: STATE MACHINE CONSISTENCY
```
system_state_machine.state ‚àà {RUNNING, DEGRADED, SAFE_HALT, RECOVERY, FATAL}
IF state == SAFE_HALT OR state == FATAL:
  THEN trading_paused == True (enforced)
IF state == FATAL:
  THEN process MUST exit (enforced by FATAL_REAPER)
```

**–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
- `SystemStateMachine` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ `sync_to_system_state()`
- `FATAL_REAPER` thread –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏ `FATAL`

#### INV-5: DATA VALIDITY
```
‚àÄ data used in trading decision:
  MUST be validated (not None, not NaN, not stale)
  IF validation fails:
    THEN data source marked as INVALID
    THEN system_state ‚Üí DEGRADED (if recoverable) OR SAFE_HALT (if critical)
```

**–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
- `DataValidator` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Üí –ø–æ–º–µ—Ç–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∫–∞–∫ `INVALID`
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Üí `SAFE_HALT`

#### INV-6: TIMEOUT ENFORCEMENT
```
‚àÄ operation in trading decision path:
  MUST complete within TIMEOUT
  IF timeout exceeded:
    THEN operation marked as FAILED
    THEN module marked as DEGRADED
    THEN system_state ‚Üí DEGRADED (if recoverable) OR SAFE_HALT (if critical)
```

**–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–±—ë—Ä–Ω—É—Ç—ã –≤ `timeout_guard()`
- –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ —Ç–∞–π–º–∞—É—Ç–∞ ‚Üí –ø–æ–º–µ—Ç–∫–∞ –º–æ–¥—É–ª—è –∫–∞–∫ `DEGRADED`
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–∞–π–º–∞—É—Ç—ã ‚Üí `SAFE_HALT`

---

## 2Ô∏è‚É£ –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø –ú–û–î–£–õ–ï–ô

### CRITICAL (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ)

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** –ú–æ–¥—É–ª—å, –±–µ–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ —Å–∏—Å—Ç–µ–º–∞ **–ù–ï –ú–û–ñ–ï–¢** –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ç–æ—Ä–≥–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è.

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:**
- `system_state ‚Üí SAFE_HALT`
- –¢–æ—Ä–≥–æ–≤–ª—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
- –ù–µ—Ç fail-open –ø–æ–≤–µ–¥–µ–Ω–∏—è

**–°–ø–∏—Å–æ–∫ CRITICAL –º–æ–¥—É–ª–µ–π:**

1. **DecisionCore**
   - **–†–æ–ª—å:** –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π
   - **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** `SAFE_HALT` –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
   - **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –î–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ `DECISION_CORE_TIMEOUT` (5 —Å–µ–∫—É–Ω–¥)

2. **SystemStateMachine**
   - **–†–æ–ª—å:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
   - **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** `FATAL` (—Ç—Ä–µ–±—É–µ—Ç restart)
   - **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –î–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)

3. **SystemGuardian**
   - **–†–æ–ª—å:** –ü—Ä–∏–Ω—É–∂–¥–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
   - **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** `FATAL` (—Ç—Ä–µ–±—É–µ—Ç restart)
   - **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –î–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ

4. **RiskExposureBrain** (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
   - **–†–æ–ª—å:** –†–∞—Å—á—ë—Ç —Ä–∏—Å–∫–∞ –∏ —ç–∫—Å–ø–æ–∑–∏—Ü–∏–∏
   - **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** `SAFE_HALT`
   - **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –î–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ `BRAIN_TIMEOUT` (3 —Å–µ–∫—É–Ω–¥—ã)

### NON_CRITICAL (–ù–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ)

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** –ú–æ–¥—É–ª—å, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏.

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:**
- –ú–æ–¥—É–ª—å –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ `DEGRADED`
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é
- –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

**–°–ø–∏—Å–æ–∫ NON_CRITICAL –º–æ–¥—É–ª–µ–π:**

1. **MetaDecisionBrain**
   - **–†–æ–ª—å:** –ú–µ—Ç–∞-—Ä–µ—à–µ–Ω–∏—è –æ —Ç–æ—Ä–≥–æ–≤–ª–µ
   - **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É, –Ω–æ –±–µ–∑ –º–µ—Ç–∞-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
   - **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

2. **MarketRegimeBrain**
   - **–†–æ–ª—å:** –ê–Ω–∞–ª–∏–∑ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞
   - **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ–∂–∏–º–µ
   - **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

3. **CognitiveFilter**
   - **–†–æ–ª—å:** –§–∏–ª—å—Ç—Ä –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã—Ö –æ—à–∏–±–æ–∫
   - **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
   - **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

4. **OpportunityAwareness**
   - **–†–æ–ª—å:** –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
   - **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö
   - **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

5. **PortfolioBrain**
   - **–†–æ–ª—å:** –ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
   - **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
   - **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

6. **PositionSizer**
   - **–†–æ–ª—å:** –†–∞—Å—á—ë—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
   - **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏
   - **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

7. **TelegramBot**
   - **–†–æ–ª—å:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –ö–û–ù–§–ò–ì–£–†–ò–†–£–ï–ú–ê–Ø –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å –º–æ–¥—É–ª—è –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.

**–§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:** `module_criticality.json`

```json
{
  "modules": {
    "MetaDecisionBrain": {
      "criticality": "CRITICAL",
      "timeout_seconds": 3.0,
      "fail_safe_behavior": "BLOCK_TRADING"
    },
    "MarketRegimeBrain": {
      "criticality": "NON_CRITICAL",
      "timeout_seconds": 5.0,
      "fail_safe_behavior": "CONTINUE_WITH_DEGRADED"
    }
  }
}
```

---

## 3Ô∏è‚É£ –°–ò–°–¢–ï–ú–ù–´–ï –°–û–°–¢–û–Ø–ù–ò–Ø (State Machine)

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è State Machine

**–§–∞–π–ª:** `core/system_state_machine.py` (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π)

### –°–æ—Å—Ç–æ—è–Ω–∏—è

#### RUNNING
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å–∏—Å—Ç–µ–º—ã

**–†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- –í—Å–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –í—Å–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

**–ü–µ—Ä–µ—Ö–æ–¥—ã:**
- `RUNNING ‚Üí DEGRADED`: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è (–Ω–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞)
- `RUNNING ‚Üí SAFE_HALT`: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞
- `RUNNING ‚Üí FATAL`: –ù–µ–æ–±—Ä–∞—Ç–∏–º–∞—è –æ—à–∏–±–∫–∞

#### DEGRADED
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é

**–†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- –¢–æ—Ä–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ DecisionCore –¥–æ—Å—Ç—É–ø–µ–Ω)
- –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (—á–∞—Å—Ç–∏—á–Ω–æ)
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏

**–ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö NON_CRITICAL –º–æ–¥—É–ª–µ–π

**–ü–µ—Ä–µ—Ö–æ–¥—ã:**
- `DEGRADED ‚Üí RUNNING`: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤
- `DEGRADED ‚Üí SAFE_HALT`: –î–µ–≥—Ä–∞–¥–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–¥—É–ª—è
- `DEGRADED ‚Üí FATAL`: –ù–µ–æ–±—Ä–∞—Ç–∏–º–∞—è –æ—à–∏–±–∫–∞

#### SAFE_HALT
**–û–ø–∏—Å–∞–Ω–∏–µ:** –¢–æ—Ä–≥–æ–≤–ª—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞

**–†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ

**–ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- **–õ–Æ–ë–´–ï —Ç–æ—Ä–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
- –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫

**–ü–µ—Ä–µ—Ö–æ–¥—ã:**
- `SAFE_HALT ‚Üí RECOVERY`: –ù–∞—á–∞–ª–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- `SAFE_HALT ‚Üí FATAL`: TTL –∏—Å—Ç—ë–∫ –∏–ª–∏ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–∞—è –æ—à–∏–±–∫–∞

**TTL:** 600 —Å–µ–∫—É–Ω–¥ (10 –º–∏–Ω—É—Ç)
- –ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ `SAFE_HALT` –¥–æ–ª—å—à–µ TTL ‚Üí `FATAL`

#### RECOVERY
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ `SAFE_HALT`

**–†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –º–æ–¥—É–ª–µ–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –¢–µ—Å—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–±–µ–∑ —Ç–æ—Ä–≥–æ–≤–ª–∏)

**–ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- **–õ–Æ–ë–´–ï —Ç–æ—Ä–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
- –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫

**–ü–µ—Ä–µ—Ö–æ–¥—ã:**
- `RECOVERY ‚Üí RUNNING`: –£—Å–ø–µ—à–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (3 —É—Å–ø–µ—à–Ω—ã—Ö —Ü–∏–∫–ª–∞)
- `RECOVERY ‚Üí SAFE_HALT`: –û—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- `RECOVERY ‚Üí FATAL`: –ù–µ–æ–±—Ä–∞—Ç–∏–º–∞—è –æ—à–∏–±–∫–∞

#### FATAL
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞, —Ç—Ä–µ–±—É—é—â–∞—è restart

**–†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–µ
- **os._exit(FATAL_EXIT_CODE)** (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ)

**–ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- **–í–°–ï –æ–ø–µ—Ä–∞—Ü–∏–∏** (–∫—Ä–æ–º–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞)

**–ü–µ—Ä–µ—Ö–æ–¥—ã:**
- `FATAL ‚Üí (–Ω–µ—Ç)` - Terminal state

**–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ:**
- `FATAL_REAPER` thread –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —á–µ—Ä–µ–∑ `os._exit()`
- –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ `FATAL`

### –¢–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

| From State | To State | Trigger | Owner |
|------------|----------|---------|-------|
| RUNNING | DEGRADED | NON_CRITICAL module unavailable | SystemGuardian |
| RUNNING | SAFE_HALT | CRITICAL module unavailable | SystemGuardian |
| RUNNING | FATAL | Unrecoverable error | ErrorHandler |
| DEGRADED | RUNNING | 3 successful cycles | RecoveryMechanism |
| DEGRADED | SAFE_HALT | CRITICAL module unavailable | SystemGuardian |
| DEGRADED | FATAL | Unrecoverable error | ErrorHandler |
| SAFE_HALT | RECOVERY | All CRITICAL modules available | RecoveryMechanism |
| SAFE_HALT | FATAL | TTL expired (>600s) | TTLGuard |
| RECOVERY | RUNNING | 3 successful cycles | RecoveryMechanism |
| RECOVERY | SAFE_HALT | Recovery failed | RecoveryMechanism |
| RECOVERY | FATAL | Unrecoverable error | ErrorHandler |

---

## 4Ô∏è‚É£ FAIL-SAFE BY DEFAULT

### –ü—Ä–∏–Ω—Ü–∏–ø

**"–ï—Å–ª–∏ —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è ‚Äî –±–ª–æ–∫–∏—Ä—É–π —Ç–æ—Ä–≥–æ–≤–ª—é"**

### –ü—Ä–∞–≤–∏–ª–∞ Fail-Safe

#### RULE-1: CRITICAL MODULE FAILURE
```
IF critical_module.unavailable OR critical_module.invalid OR critical_module.timeout:
  THEN system_state ‚Üí SAFE_HALT
  THEN trading_paused = True (enforced)
  THEN log CRITICAL alert
```

#### RULE-2: DATA VALIDATION FAILURE
```
IF critical_data.invalid OR critical_data.stale:
  THEN data_source.marked = INVALID
  THEN IF data_source is CRITICAL:
    THEN system_state ‚Üí SAFE_HALT
  ELSE:
    THEN system_state ‚Üí DEGRADED
```

#### RULE-3: TIMEOUT ENFORCEMENT
```
IF operation.timeout_exceeded:
  THEN operation.marked = FAILED
  THEN module.marked = DEGRADED
  THEN IF module is CRITICAL:
    THEN system_state ‚Üí SAFE_HALT
  ELSE:
    THEN system_state ‚Üí DEGRADED
```

#### RULE-4: EXCEPTION HANDLING
```
IF exception in trading decision path:
  THEN log ERROR with full context
  THEN IF exception is recoverable:
    THEN system_state ‚Üí DEGRADED
  ELSE:
    THEN system_state ‚Üí SAFE_HALT
```

#### RULE-5: NO FAIL-OPEN FOR CRITICAL
```
IF critical_module:
  THEN fail_open = FORBIDDEN
  THEN fail_safe = REQUIRED
  THEN IF module unavailable:
    THEN trading MUST be blocked
```

---

## 5Ô∏è‚É£ –£–°–ò–õ–ï–ù–ò–ï DECISION CORE

### Decision Core –∫–∞–∫ Single Source of Truth

**–ü—Ä–∏–Ω—Ü–∏–ø:** –í—Å–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ `DecisionCore.should_i_trade()`

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         SystemGuardian                   ‚îÇ
‚îÇ  (Enforces Decision Core Authority)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ
                    ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         DecisionCore                     ‚îÇ
‚îÇ  (Single Source of Truth)                ‚îÇ
‚îÇ  - should_i_trade()                     ‚îÇ
‚îÇ  - get_risk_status()                     ‚îÇ
‚îÇ  - get_full_context()                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚ñº                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Gatekeeper  ‚îÇ      ‚îÇ  Other Consumers ‚îÇ
‚îÇ  (enforced)  ‚îÇ      ‚îÇ  (enforced)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

1. **Gatekeeper –ø—Ä–æ–≤–µ—Ä–∫–∞:**
   ```python
   def send_signal(...):
       # INV-2: Decision Core Authority
       decision = self.decision_core.should_i_trade(symbol, system_state)
       if not decision.can_trade:
           return  # Early exit - NO bypass
   ```

2. **SystemGuardian –ø—Ä–æ–≤–µ—Ä–∫–∞:**
   ```python
   def enforce_decision_core_authority():
       # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ DecisionCore
       if any_bypass_detected:
           system_state ‚Üí SAFE_HALT
   ```

3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ—à–µ–Ω–∏–π:**
   ```python
   # –í—Å–µ —Ä–µ—à–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å decision_source="DecisionCore"
   decision_trace.log_decision(
       decision_source="DecisionCore",
       allow_trading=decision.can_trade,
       reason=decision.reason
   )
   ```

---

## 6Ô∏è‚É£ –ì–õ–û–ë–ê–õ–¨–ù–´–ô –°–õ–û–ô –ü–û–õ–ò–¢–ò–ö–ò / –ü–†–ò–ù–£–ñ–î–ï–ù–ò–Ø

### SystemGuardian

**–§–∞–π–ª:** `core/system_guardian.py`

**–†–æ–ª—å:** –ü—Ä–∏–Ω—É–∂–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ –ø–æ–ª–∏—Ç–∏–∫

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. ModuleHealthMonitor
**–†–æ–ª—å:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π

```python
class ModuleHealthMonitor:
    def check_module_health(self, module: Module) -> ModuleHealth:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ –º–æ–¥—É–ª—è:
        - –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
        - –í–∞–ª–∏–¥–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
        - –¢–∞–π–º–∞—É—Ç—ã
        - –ü–æ—Å–ª–µ–¥–Ω–∏–π heartbeat
        """
        pass
    
    def mark_module_degraded(self, module: Module, reason: str):
        """–ü–æ–º–µ—á–∞–µ—Ç –º–æ–¥—É–ª—å –∫–∞–∫ DEGRADED"""
        pass
    
    def mark_module_critical_failure(self, module: Module, reason: str):
        """–ü–æ–º–µ—á–∞–µ—Ç –º–æ–¥—É–ª—å –∫–∞–∫ CRITICAL FAILURE ‚Üí SAFE_HALT"""
        pass
```

#### 2. InvariantEnforcer
**–†–æ–ª—å:** –ü—Ä–∏–Ω—É–∂–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

```python
class InvariantEnforcer:
    def check_all_invariants(self) -> List[InvariantViolation]:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã:
        - INV-1: CRITICAL MODULE AVAILABILITY
        - INV-2: DECISION CORE AUTHORITY
        - INV-3: META DECISION BRAIN CRITICALITY
        - INV-4: STATE MACHINE CONSISTENCY
        - INV-5: DATA VALIDITY
        - INV-6: TIMEOUT ENFORCEMENT
        """
        pass
    
    def enforce_invariant(self, invariant: Invariant):
        """–ü—Ä–∏–Ω—É–∂–¥–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞"""
        pass
```

#### 3. PolicyEnforcer
**–†–æ–ª—å:** –ü—Ä–∏–Ω—É–∂–¥–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ fail-safe

```python
class PolicyEnforcer:
    def enforce_fail_safe_policy(self, module: Module, failure: Failure):
        """
        –ü—Ä–∏–º–µ–Ω—è–µ—Ç fail-safe –ø–æ–ª–∏—Ç–∏–∫—É:
        - CRITICAL module failure ‚Üí SAFE_HALT
        - NON_CRITICAL module failure ‚Üí DEGRADED
        - Data validation failure ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        - Timeout ‚Üí –ø–æ–º–µ—Ç–∫–∞ –º–æ–¥—É–ª—è –∫–∞–∫ DEGRADED
        """
        pass
```

#### 4. TradingGate
**–†–æ–ª—å:** –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Ç–æ—Ä–≥–æ–≤–ª–µ–π

```python
class TradingGate:
    def can_trade(self) -> TradingPermission:
        """
        –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Ç–æ—Ä–≥–æ–≤–ª–µ–π:
        - System state (RUNNING only)
        - All CRITICAL modules available
        - DecisionCore available
        - No invariant violations
        """
        pass
    
    def block_trading(self, reason: str):
        """–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–æ—Ä–≥–æ–≤–ª—é"""
        system_state ‚Üí SAFE_HALT
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SystemGuardian

```python
# –í runner.py - –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ç–æ—Ä–≥–æ–≤—ã–º —Ü–∏–∫–ª–æ–º
async def market_analysis_loop():
    # 1. SystemGuardian –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã
    violations = await system_guardian.check_all_invariants()
    if violations:
        await system_guardian.handle_violations(violations)
        return  # Early exit
    
    # 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –º–æ–¥—É–ª–µ–π
    health_status = await system_guardian.check_module_health()
    if health_status.has_critical_failures:
        system_state ‚Üí SAFE_HALT
        return
    
    # 3. TradingGate –ø—Ä–æ–≤–µ—Ä–∫–∞
    permission = await trading_gate.can_trade()
    if not permission.allowed:
        return  # Early exit
    
    # 4. –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
    # ...
```

---

## 7Ô∏è‚É£ –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

1. **`core/system_guardian.py`** - SystemGuardian
2. **`core/module_registry.py`** - –†–µ–µ—Å—Ç—Ä –º–æ–¥—É–ª–µ–π —Å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å—é
3. **`core/data_validator.py`** - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
4. **`core/timeout_guard.py`** - –ó–∞—â–∏—Ç–∞ –æ—Ç —Ç–∞–π–º–∞—É—Ç–æ–≤
5. **`config/module_criticality.json`** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏

### –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤

1. **`core/system_state_machine.py`** - –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π
2. **`core/decision_core.py`** - –£—Å–∏–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–∞
3. **`execution/gatekeeper.py`** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SystemGuardian
4. **`runner.py`** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ü–∏–∫–ª–æ–º

---

## 8Ô∏è‚É£ –û–ë–û–°–ù–û–í–ê–ù–ò–ï FAIL-SAFE

### –ü–æ—á–µ–º—É —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å fail-safe –ø–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

1. **–§–æ—Ä–º–∞–ª—å–Ω—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã:**
   - –í—Å–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã —è–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è
   - –ù–∞—Ä—É—à–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞ ‚Üí –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏

2. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π:**
   - CRITICAL –º–æ–¥—É–ª–∏ ‚Üí fail-safe –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏)
   - NON_CRITICAL –º–æ–¥—É–ª–∏ ‚Üí graceful degradation

3. **State Machine:**
   - –Ø–≤–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å —á—ë—Ç–∫–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
   - `SAFE_HALT` –∏ `FATAL` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —Ç–æ—Ä–≥–æ–≤–ª–∏
   - TTL –¥–ª—è `SAFE_HALT` –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –∑–∞–≤–∏—Å–∞–Ω–∏–µ

4. **Fail-Safe –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
   - –í—Å–µ –ø—Ä–∞–≤–∏–ª–∞ fail-safe —è–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
   - –ù–µ—Ç fail-open –ø–æ–≤–µ–¥–µ–Ω–∏—è –¥–ª—è CRITICAL –º–æ–¥—É–ª–µ–π
   - "–ï—Å–ª–∏ —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è ‚Äî –±–ª–æ–∫–∏—Ä—É–π"

5. **Decision Core Authority:**
   - –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π
   - –ù–µ—Ç –æ–±—Ö–æ–¥–Ω—ã—Ö –ø—É—Ç–µ–π
   - –í—Å–µ —Ä–µ—à–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

6. **SystemGuardian:**
   - –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–ª–æ–π –ø—Ä–∏–Ω—É–∂–¥–µ–Ω–∏—è
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ü–∏–∫–ª–æ–º
   - TradingGate –∫–∞–∫ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –ì–∞—Ä–∞–Ω—Ç–∏–∏

‚úÖ **–°–∏—Å—Ç–µ–º–∞ –ù–ï –ú–û–ñ–ï–¢ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å, –µ—Å–ª–∏:**
- CRITICAL –º–æ–¥—É–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –î–∞–Ω–Ω—ã–µ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã
- –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞—Ä—É—à–µ–Ω
- System state != RUNNING
- DecisionCore –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

‚úÖ **–°–∏—Å—Ç–µ–º–∞ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–æ—Ä–≥–æ–≤–ª—é –ø—Ä–∏:**
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–±–ª–µ–º—ã
- –ü—Ä–µ–≤—ã—à–µ–Ω–∏–∏ —Ç–∞–π–º–∞—É—Ç–∞
- –ù–∞—Ä—É—à–µ–Ω–∏–∏ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞
- –ù–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

‚úÖ **–°–∏—Å—Ç–µ–º–∞ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø—Ä–∏:**
- FATAL —Å–æ—Å—Ç–æ—è–Ω–∏–∏
- –ù–µ–æ–±—Ä–∞—Ç–∏–º–æ–π –æ—à–∏–±–∫–µ
- –ò—Å—Ç–µ—á–µ–Ω–∏–∏ TTL –¥–ª—è SAFE_HALT

---

## 9Ô∏è‚É£ –ú–ò–ì–†–ê–¶–ò–Ø

### –≠—Ç–∞–ø—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

1. **–≠—Ç–∞–ø 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**
   - –°–æ–∑–¥–∞—Ç—å `SystemGuardian`
   - –°–æ–∑–¥–∞—Ç—å `ModuleRegistry`
   - –†–∞—Å—à–∏—Ä–∏—Ç—å `SystemStateMachine`

2. **–≠—Ç–∞–ø 2: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**
   - –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –º–æ–¥—É–ª–∏
   - –°–æ–∑–¥–∞—Ç—å `module_criticality.json`
   - –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

3. **–≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `SystemGuardian` –≤ `runner.py`
   - –û–±–Ω–æ–≤–∏—Ç—å `Gatekeeper` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–æ–∫
   - –û–±–Ω–æ–≤–∏—Ç—å `DecisionCore` –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–∞

4. **–≠—Ç–∞–ø 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –¢–µ—Å—Ç—ã –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
   - –¢–µ—Å—Ç—ã fail-safe –ø–æ–≤–µ–¥–µ–Ω–∏—è
   - –¢–µ—Å—Ç—ã state machine –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

5. **–≠—Ç–∞–ø 5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
   - –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö
   - –ú–µ—Ç—Ä–∏–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã

---

## üîü –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å **fail-safe –ø–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏** –±–ª–∞–≥–æ–¥–∞—Ä—è:

1. ‚úÖ –§–æ—Ä–º–∞–ª—å–Ω—ã–º –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞–º —Å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º
2. ‚úÖ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –º–æ–¥—É–ª–µ–π (CRITICAL/NON_CRITICAL)
3. ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π state machine —Å —è–≤–Ω—ã–º–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
4. ‚úÖ Fail-safe –ø—Ä–∞–≤–∏–ª–∞–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
5. ‚úÖ –£—Å–∏–ª–µ–Ω–Ω–æ–º—É –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç—É Decision Core
6. ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω–æ–º—É —Å–ª–æ—é –ø—Ä–∏–Ω—É–∂–¥–µ–Ω–∏—è (SystemGuardian)

**–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞–∑ –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω**, —Ç–∞–∫ –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–æ—Ä–≥–æ–≤–ª—é –ø—Ä–∏ –ª—é–±–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–¥—É–ª—è.

