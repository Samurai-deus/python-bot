# COGNITIVE ENGINE - –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

**–î–∞—Ç–∞:** 2024-12-19  
**–ó–∞–¥–∞—á–∞:** –í–≤–µ—Å—Ç–∏ –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–π —Å–ª–æ–π Confidence & Entropy

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

### 1. –°–æ–∑–¥–∞–Ω Cognitive Engine

**–§–∞–π–ª:** `core/cognitive_engine.py`

**–§—É–Ω–∫—Ü–∏–∏:**
- ‚úÖ `calculate_confidence(snapshot: SignalSnapshot) -> float`
- ‚úÖ `calculate_entropy(snapshot: SignalSnapshot) -> float`

---

## üìã –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ô –ü–†–ò–ù–¶–ò–ü

**Confidence ‚â† –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**  
**Entropy ‚â† –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å**

–≠—Ç–æ **–º–µ—Ç–∞-–æ—Ü–µ–Ω–∫–∏ –º—ã—à–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã**, –∞ –Ω–µ market indicators.

---

## üîπ CALCULATE_CONFIDENCE

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**  
–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–µ–ø–µ–Ω—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö –ø–æ–¥—Å–∏—Å—Ç–µ–º.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `float ‚àà [0.0, 1.0]`
- `0.0` = –ø–æ–ª–Ω–∞—è –Ω–µ—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
- `1.0` = –ø–æ–ª–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å

**–§–∞–∫—Ç–æ—Ä—ã (–≤–∑–≤–µ—à–µ–Ω–Ω–æ):**

1. **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å MarketState –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º (30%)**
   - –í—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ ‚Üí –≤—ã—Å–æ–∫–∏–π confidence
   - –†–∞–∑–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è ‚Üí –Ω–∏–∑–∫–∏–π confidence

2. **–û—Ç–Ω–æ—à–µ–Ω–∏–µ score / score_max (25%)**
   - –í—ã—Å–æ–∫–∏–π score ‚Üí –≤—ã—Å–æ–∫–∏–π confidence
   - –ù–∏–∑–∫–∏–π score ‚Üí –Ω–∏–∑–∫–∏–π confidence

3. **–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ decision –∏ risk_level (20%)**
   - ENTER + LOW risk ‚Üí –≤—ã—Å–æ–∫–∏–π confidence
   - ENTER + HIGH risk ‚Üí –Ω–∏–∑–∫–∏–π confidence

4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (15%)**
   - –í—ã—Å–æ–∫–∏–π score + –≤—ã—Å–æ–∫–∏–π risk ‚Üí —à—Ç—Ä–∞—Ñ
   - –í—ã—Å–æ–∫–∏–π score + SKIP/BLOCK ‚Üí —à—Ç—Ä–∞—Ñ

5. **–†–µ–∂–∏–º —Ä—ã–Ω–∫–∞ –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (10%)**
   - TREND + RISK_ON ‚Üí boost
   - NORMAL volatility ‚Üí boost
   - EXTREME volatility ‚Üí —à—Ç—Ä–∞—Ñ

---

## üîπ CALCULATE_ENTROPY

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**  
–ò–∑–º–µ—Ä–∏—Ç—å –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—É—é –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å —Ä—ã–Ω–∫–∞.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `float ‚àà [0.0, 1.0]`
- `0.0` = –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω
- `1.0` = —Ö–∞–æ—Ç–∏—á–µ–Ω

**–§–∞–∫—Ç–æ—Ä—ã:**

1. **–†–∞–∑–±—Ä–æ—Å MarketState –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º (40%)**
   - –í—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ ‚Üí –Ω–∏–∑–∫–∞—è entropy
   - –†–∞–∑–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è ‚Üí –≤—ã—Å–æ–∫–∞—è entropy

2. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç score vs decision (30%)**
   - –í—ã—Å–æ–∫–∏–π score + BLOCK ‚Üí –≤—ã—Å–æ–∫–∞—è entropy
   - –ù–∏–∑–∫–∏–π score + ENTER ‚Üí –≤—ã—Å–æ–∫–∞—è entropy

3. **–í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (20%)**
   - EXTREME volatility ‚Üí –≤—ã—Å–æ–∫–∞—è entropy
   - LOW volatility ‚Üí –Ω–∏–∑–∫–∞—è entropy

4. **–ù–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å —Ä–µ–∂–∏–º–∞ (10%)**
   - –ù–∏–∑–∫–∞—è confidence –≤ —Ä–µ–∂–∏–º–µ ‚Üí –≤—ã—Å–æ–∫–∞—è entropy

---

## üîÑ –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –í SIGNALSNAPSHOT

### –û–±–Ω–æ–≤–ª—ë–Ω SignalSnapshot:

```python
# –ë—ã–ª–æ:
confidence: Optional[float] = None
entropy: Optional[float] = None

# –°—Ç–∞–ª–æ:
confidence: float = 0.0  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
entropy: float = 0.0      # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
```

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã:

```python
# –í __post_init__:
0.0 <= confidence <= 1.0  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
0.0 <= entropy <= 1.0     # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```

---

## üîÑ –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –í SIGNAL_GENERATOR

### –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è snapshot:

1. **–°–æ–∑–¥–∞—ë–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π snapshot** —Å `confidence=0.0` –∏ `entropy=0.0`
2. **–í—ã—á–∏—Å–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏:**
   ```python
   confidence = calculate_confidence(temp_snapshot)
   entropy = calculate_entropy(temp_snapshot)
   ```
3. **–°–æ–∑–¥–∞—ë–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π snapshot** —Å –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

### –ö–æ–¥:

```python
# –°–æ–∑–¥–∞—ë–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π snapshot
temp_snapshot = SignalSnapshot(
    ...,
    confidence=0.0,  # –í—Ä–µ–º–µ–Ω–Ω–æ–µ
    entropy=0.0      # –í—Ä–µ–º–µ–Ω–Ω–æ–µ
)

# –í—ã—á–∏—Å–ª—è–µ–º –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
confidence = calculate_confidence(temp_snapshot)
entropy = calculate_entropy(temp_snapshot)

# –°–æ–∑–¥–∞—ë–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π snapshot
snapshot = SignalSnapshot(
    ...,
    confidence=confidence,
    entropy=entropy
)
```

---

## üìä –ü–†–ò–ú–ï–†–´ –†–ê–°–ß–Å–¢–ê

### –ü—Ä–∏–º–µ—Ä 1: –í—ã—Å–æ–∫–∏–π Confidence

```python
snapshot = SignalSnapshot(
    states={"15m": MarketState.D, "30m": MarketState.D, "1h": MarketState.D},
    score=100,
    score_max=125,
    decision=SignalDecision.ENTER,
    risk_level=RiskLevel.LOW,
    volatility_level=VolatilityLevel.NORMAL,
    ...
)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
confidence ‚âà 0.85  # –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
entropy ‚âà 0.15    # –ù–∏–∑–∫–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å
```

### –ü—Ä–∏–º–µ—Ä 2: –ù–∏–∑–∫–∏–π Confidence

```python
snapshot = SignalSnapshot(
    states={"15m": MarketState.D, "30m": MarketState.A, "1h": MarketState.B},
    score=40,
    score_max=125,
    decision=SignalDecision.SKIP,
    risk_level=RiskLevel.HIGH,
    volatility_level=VolatilityLevel.EXTREME,
    ...
)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
confidence ‚âà 0.25  # –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
entropy ‚âà 0.80    # –í—ã—Å–æ–∫–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å
```

### –ü—Ä–∏–º–µ—Ä 3: –ö–æ–Ω—Ñ–ª–∏–∫—Ç

```python
snapshot = SignalSnapshot(
    states={"15m": MarketState.D, "30m": MarketState.D},
    score=90,  # –í—ã—Å–æ–∫–∏–π score
    score_max=125,
    decision=SignalDecision.BLOCK,  # –ù–æ –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
    risk_level=RiskLevel.HIGH,      # –ò –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫
    ...
)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
confidence ‚âà 0.30  # –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏–∑-–∑–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
entropy ‚âà 0.75    # –í—ã—Å–æ–∫–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å –∏–∑-–∑–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞
```

---

## ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–ô

### 1. –ß–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ `calculate_confidence()` - —á–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è
- ‚úÖ `calculate_entropy()` - —á–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è
- ‚úÖ –ù–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤–Ω–µ—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –û—Å–Ω–æ–≤–∞–Ω—ã –¢–û–õ–¨–ö–û –Ω–∞ snapshot

### 2. –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å
- ‚úÖ –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Üí –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ –ù–µ—Ç —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏
- ‚úÖ –ù–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### 3. –î–∏–∞–ø–∞–∑–æ–Ω—ã
- ‚úÖ `confidence ‚àà [0.0, 1.0]`
- ‚úÖ `entropy ‚àà [0.0, 1.0]`
- ‚úÖ –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤ `__post_init__`

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –í—ã—á–∏—Å–ª—è—é—Ç—Å—è –≤ `signal_generator.py`
- ‚úÖ –ó–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –ü–û–°–õ–ï scoring / risk / decision
- ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –≤ `SignalSnapshot`

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢

### –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:
1. ‚úÖ **Cognitive Engine —Å–æ–∑–¥–∞–Ω** —Å –¥–≤—É–º—è —á–∏—Å—Ç—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
2. ‚úÖ **SignalSnapshot –æ–±–Ω–æ–≤–ª—ë–Ω** - confidence –∏ entropy –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
3. ‚úÖ **–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
4. ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ signal_generator** - –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—Å–µ—Ö —Ä–∞—Å—á—ë—Ç–æ–≤
5. ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - journal.py –æ–±–Ω–æ–≤–ª—ë–Ω

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
- ‚úÖ –ú–µ—Ç–∞-–æ—Ü–µ–Ω–∫–∏ –º—ã—à–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ù–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç market indicators
- ‚úÖ –ß–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ

---

*Cognitive Engine –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.*

